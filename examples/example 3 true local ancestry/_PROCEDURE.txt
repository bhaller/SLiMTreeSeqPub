True local ancestry along the chromosome after admixture between subpopulations
Status: finished


PROCEDURE FOR RUNNING EXAMPLE 3:

cd into the "example 3 simple neutral" directory

time ../slim -t -m -s 0 "./ex3_TS.slim"



RESULTS:

ex3_TS.slim took 0m0.429s user + 0m0.075s system == 0.504 seconds, 69.7852MB peak memory



ANALYSIS:

we want to assess the fractional true local ancestry at each position along the chromosome
msprime docs: https://msprime.readthedocs.io/en/stable/api.html

so in Python I think we want to:

make a TreeSequence object
call trees() to get a tree iterator
iterate over the trees (SparseTree)
for each tree note its positional start and end (.interval) and its root ancestor subpop (.population(root)) â€“ multiple roots, it turns out
average the ancestry at the site across all trees, weighted by the number of leaf samples in that tree (the tree root is also a sample here)
then just plot mean ancestral subpop against position

time python ../msp-tree-ancestry.py --basedir . --tree_file ex3_TS.trees --logfile ex3_TS_ancestry.csv

(90.5 seconds)

then use ./plot_ancestry.R to make the plot

