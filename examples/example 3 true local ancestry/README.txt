This example runs a SLiM simulation (involving admixture between subpopulations) and analyzes the results to produce a plot of the pattern of true local ancestry along the chromosome.

To run this example, run ex3.py in Python (Python 3.4.8 was used) from this directory:

python3 ./ex3.py

Note that the code presented for this example in our paper does not include some extraneous cruft, such as timing code, setting the current working directory, and CSV file output, for simplicity.  The plot shown in our publication is generated by plot_ancestry.R using the CSV file saved by ex3.py.


Sample results:

// ********** Initial memory usage: 1114112 bytes (1088K, 1.0625MB)
// ********** Peak memory usage: 52305920 bytes (51080K, 49.8828MB)
Time for SLiM with tree-sequence recording: 0.4612639010010753

Time for msprime tree-height analysis: 92.00589034800214

./ancestry.pdf
./ex3_TS_ancestry.csv

