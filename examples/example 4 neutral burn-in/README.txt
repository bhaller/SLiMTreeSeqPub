This example shows how to add a neutral burn-in period to a non-neutral "jackpot" model in which fecundity is quite skewed.  This example involves running the non-neutral model in SLiM first, and then "recapitating" it in msprime by constructing a coalescent history for all of the initial individuals in the forward simulation and overlaying neutral mutations onto that constructed history.

To run this example, run ex4.py in Python (Python 3.4.8 was used) from this directory:

python3 ./ex4.py

Note that the code presented for this example in our paper does not include some extraneous cruft, such as timing code, setting the current working directory, and CSV file output, for simplicity.  The plot shown in our publication is generated by plot_heights.R using the CSV file saved by ex2.py.


Sample results:
// ********** Initial memory usage: 1077248 bytes (1052K, 1.02734MB)
// ********** Peak memory usage: 5788991488 bytes (5.65331e+06K, 5520.81MB)
Time for SLiM with tree-sequence recording: 381.407748172991

Time for msprime recapitation: 7.073345648008399

Time for msprime mutation overlay: 8.72982140496606


Probably the best alternative to recapitation would be to use msprime to generate neutral mutations for a coalesced population, providing the initial burn-in state, and then load that into SLiM and simulate from there.  The msp_coalescent_ex4.py script runs the coalescent for that, to see how long it would take.  Its results:

Time for msprime coalescent: 573.4211697420105
