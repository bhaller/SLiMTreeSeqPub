This example shows how to add a neutral burn-in period to a non-neutral "jackpot" model in which fecundity is quite skewed.  This example involves running the non-neutral model in SLiM first, and then "recapitating" it in msprime by constructing a coalescent history for all of the initial individuals in the forward simulation and overlaying neutral mutations onto that constructed history.

To run this example, run ex4.py in Python (Python 3.4.8 was used) from this directory:

python3 ./ex4.py

Note that the code presented for this example in our paper does not include some extraneous cruft, such as timing code, setting the current working directory, and CSV file output, for simplicity.  The plot shown in our publication is generated by plot_heights.R using the CSV file saved by ex2.py.


Sample results:
// ********** Initial memory usage: 1077248 bytes (1052K, 1.02734MB)
// ********** Peak memory usage: 4940668928 bytes (4.82487e+06K, 4711.79MB)
Time for SLiM with tree-sequence recording:  46.04891963400587 

Time for msprime recapitation: 0.4107658069988247

Time for msprime mutation overlay: 0.5757085929944878

./recapitation.pdf
./ex4_TS_decap_heights.csv
./ex4_TS_recap_heights.csv


The best alternative to recapitation would be to use SLiM to run the initial burn-in state.  The ex4_noTS.slim model produces:

Generation 10000: 2628.53
Generation 20000: 6758.25

Extrapolating from this result (4129.72 seconds for 10,000 generations) to 10N (1,000,000) generations gives an estimate of 412972 total seconds (114.7 hours).  This estimate is probably quite low, since the model is nowhere near mutation-drift balance yet and is thus still slowing down.


