This example runs a SLiM simulation (involving a repeated pattern of genes along a chromosome) and analyzes the results to produce a plot of the "dip in diversity" observed near loci under selection, due to background selection.

To run this example, run ex2.py in Python (Python 3.4.8 was used) from this directory:

python3 ./ex2.py

Note that the code presented for this example in our paper does not include some extraneous cruft, such as timing code, setting the current working directory, and CSV file output, for simplicity.  The plot shown in our publication is generated by plot_heights.R using the CSV file saved by ex2.py.


Sample results:

// ********** Initial memory usage: 1069056 bytes (1044K, 1.01953MB)
// ********** Peak memory usage: 2680295424 bytes (2.61748e+06K, 2556.13MB)
Time for SLiM with tree-sequence recording: 15501.216081151004

Time for msprime tree-height analysis: 13.722537207999267

Time for tree-height post-processing: 73.73104108199914

./dip.pdf
./ex2_TS_heights.csv
